---
import AppLayout from "../layouts/AppLayout.astro";
import { DashboardContent } from "../components/dashboard/DashboardContent";
import { requireAuth } from "../lib/auth/helpers";

// Middleware (src/middleware/index.ts) handles primary route protection.
// This is a defense-in-depth check to ensure user is authenticated.
const redirect = requireAuth(Astro.locals.user);
if (redirect) {
  return redirect;
}

// User is available in Astro.locals but not used in this page
---

<AppLayout title="Dashboard - DoFIRE">
  <DashboardContent client:only="react" />
</AppLayout>
